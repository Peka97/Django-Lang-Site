{% extends 'main/base.html' %}
{% load static %}

{% block title %}Главная{% endblock  %}

{% block 'style' %}
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="{% static 'css/calendar.css' %}">
{% endblock  %}

{% block content %}
<div class="container bg-body-secondary">

	<div class='row'>
		<div class='col'>
			<h2 class='p-2'>Профиль учителя</h2>
		</div>
	</div>

    <div class="row justify-content-center bg-body-secondary">
		<div class='col-lg-auto my-3'>
			<img src="http://placehold.it/400x500/2c3e50/3498db&text=User photo" class="bd-placeholder-img" width="200" height="250" alt="User photo">
		</div>
        <div class="col my-3">
			<div class=''>
				<div class='col align-self-center'>
					<h3>Личные данные</h3>
					<hr class='border-black border-2'>
					<div class='row row-cols-auto text-black'>
						<div class='col col-lg-3 align-self-center'>
							<p> Имя: </p>
						</div>
						<div class='col align-self-center'>
							<p> {{ user.first_name }} </p>
						</div>
					</div> 
					<div class='row row-cols-auto text-black align-self-center'>
						<div class='col col-lg-3'>
							<p> Фамилия: </p>
						</div>
						<div class='col align-self-center'>
							<p> {{ user.last_name }} </p>
						</div>
					</div> 
				</div> 
			</div> 
		</div> 
        <div class="col my-3">
			<h3>Статистика</h3>
			<hr class='border-black border-2'>
			<div class='row row-cols-auto text-black'>
			</div>
			<div class='row row-cols-auto text-black'>
				<div class='col col-lg-3 align-self-center'>
					<p> Занятий проведено: </p>
				</div>
				<div class='col align-self-center'>
					<p> {{ events_count_total }} </p>
				</div>
            </div>
        </div>
	</div>
	<hr class='border-black border-3'>
	<div class='row'>
		<div class='col'>
			<h2>Сервисы</h2>
		</div>
	</div>
	<div class="row justify-content-center">
		<div class='body-calendar'>
			<section class="ftco-section">
				<div class="container">
					<div class="row justify-content-center">
						<div class="col text-center">
							<h2 class="heading-section">Календарь</h2>
						</div>
					</div>
					<div class="row">
						<div class="col">
							<div class="content w-100">
								<div class="calendar-container">
									<div class="calendar"> 
									<div class="year-header"> 
										<span class="left-button fa fa-chevron-left" id="prev"> </span> 
										<span class="year" id="label"></span> 
										<span class="right-button fa fa-chevron-right" id="next"> </span>
									</div> 
									<table class="months-table w-100"> 
										<tbody>
										<tr class="months-row">
											<td class="month">Jan</td> 
											<td class="month">Feb</td> 
											<td class="month">Mar</td> 
											<td class="month">Apr</td> 
											<td class="month">May</td> 
											<td class="month">Jun</td> 
											<td class="month">Jul</td>
											<td class="month">Aug</td> 
											<td class="month">Sep</td> 
											<td class="month">Oct</td>          
											<td class="month">Nov</td>
											<td class="month">Dec</td>
										</tr>
										</tbody>
									</table> 
									
									<table class="days-table w-100"> 
										<td class="day">Sun</td> 
										<td class="day">Mon</td> 
										<td class="day">Tue</td> 
										<td class="day">Wed</td> 
										<td class="day">Thu</td> 
										<td class="day">Fri</td> 
										<td class="day">Sat</td>
									</table>
									<div class="frame"> 
										<table class="dates-table w-100"> 
										<tbody class="tbody">  
											{{ calendar | safe }}            
										</tbody> 
										</table>
									</div> 
									</div>
								</div>
							<div class="events-container">
								<div name='empty-card' class="event-card empty-card hidden">
									<div class='event-name px-3'>Занятий сегодня нет</div>
								</div>
								{% if events %}
									{% for event in events %}
										{% if event.type == 'personal' %}
										<div name='{{ event.datetime.day }}.{{ event.datetime.month }}.{{ event.datetime.year }}' class="event-card">
											<div class="accordion accordion-flush" id="accordionFlushExample">
												<div class="accordion-item">
													<h2 class="accordion-header">
														<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{ event.pk }}" aria-expanded="false" aria-controls="flush-collapse{{ event.pk }}">
															<div class="event-name">
																{% if event.datetime.minute < 10 %}
																	{% with prefix=0 %}
																		{{ event.datetime.hour }}:{{ prefix }}{{ event.datetime.minute}}
																	{% endwith %}
																{% else %}
																	{% with prefix="" %}
																		<div class="event-name"> {{ event.datetime.hour }}:{{ prefix }}{{ event.datetime.minute}}
																	{% endwith %}
																{% endif %}
																<br>
																<i class="bi bi-person-fill" style='color: indigo'></i> {{ event.lessons.student.last_name }} {{ event.lessons.student.first_name }}
															</div>
															<div class="event-count pr-2">
																{% if event.lessons.status == 'P' %}
																	<i class="bi bi-clock text-warning"></i> 
																{% elif event.lessons..status == 'C' %}
																	<i class="bi bi-x-circle text-danger"></i>
																{% else %}
																	<i class="bi bi-check-circle text-success"></i> 
																{% endif %}

																{% if event.lessons.is_paid %}
																	<i class="bi bi-wallet text-success"></i>
																{% else %}
																	<i class="bi bi-wallet text-danger"></i> 
																{% endif %}
																<br>
																{{ event.lessons.title }}
															</div>
														</button>
													</h2>
													<div id="flush-collapse{{ event.pk }}" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
														<div class="accordion-body"> 
															<span style='font-weight: lighter; color: indigo'>HW: </span>{{ event.lessons.description }}
														</div>
													</div>
												</div>
											</div>
										</div>
										{% else %}
										<div name='{{ event.datetime.day }}.{{ event.datetime.month }}.{{ event.datetime.year }}' class="event-card">
											<div class="accordion accordion-flush" id="accordionFlushExample">
												<div class="accordion-item">
													<h2 class="accordion-header">
														<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{ event.pk }}" aria-expanded="false" aria-controls="flush-collapse{{ event.pk }}">
															<div class="event-name">
																{% if event.datetime.minute < 10 %}
																	{% with prefix=0 %}
																		{{ event.datetime.hour }}:{{ prefix }}{{ event.datetime.minute}}
																	{% endwith %}
																{% else %}
																	{% with prefix="" %}
																		{{ event.datetime.hour }}:{{ prefix }}{{ event.datetime.minute}}
																	{% endwith %}
																{% endif %}
																<br>
																<i class="bi bi-people-fill" style='color: indigo'></i>
																Group name
															</div>
															<div class="event-count">
																{{ event.title }}
															</div>
														</button>
													</h2>
													<div id="flush-collapse{{ event.pk }}" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
														<div class="accordion-body">
															{% for lesson in event.lessons %}
																<div class='event-name'> 
																	<span class='' style='font-weight: bold; color: indigo'>
																		{{ lesson.student.last_name }} {{ lesson.student.first_name }}

																		{% if lesson.status == 'P' %}
																			<i class="bi bi-clock text-warning"></i> 
																		{% elif lesson.status == 'C' %}
																			<i class="bi bi-x-circle text-danger"></i>
																		{% else %}
																			<i class="bi bi-check-circle text-success"></i> 
																		{% endif %}

																		{% if lesson.is_paid %}
																			<i class="bi bi-wallet text-success"></i>
																		{% else %}
																			<i class="bi bi-wallet text-danger"></i> 
																		{% endif %}
																	</span>
																	<div class='event-name'> 
																		<span style='font-weight: lighter; color: indigo'>HW: </span>{{ lesson.description }}
																	</div>
																	<hr class='border-primary p-0 m-0'>
																</div>
															{% endfor %}
														</div>
													</div>														
												</div>
											</div>
										</div>
										{% endif %}
									{% endfor %}
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
    </div>
</div>
{% endblock %}

{% block 'js' %}
	<script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/popper.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
	<script src="{% static 'js/main.js' %}"></script>    
{% endblock  %}